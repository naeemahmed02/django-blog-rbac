{% extends 'main.html' %}

{% block title %}
  Guest Posts
{% endblock %}

{% block content %}
  <div class="container py-5" style="max-width: 1400px;">
    <div class="d-flex justify-content-between align-items-center mb-5">
      <h2 class="mb-0">Your Articles</h2>
      <a href="{% url 'guest_posts' %}" class="btn-outline-secondary">Show All</a>
    </div>
    <div class="card-body">
      <!-- Header: Actions + Search -->
      <div class="d-flex flex-wrap justify-content-between align-items-center mb-3">
        <!-- Action Dropdown -->
        

        <!-- Search -->
        <form class="d-flex" role="search">
          <input class="form-control me-2" type="search" placeholder="Search your posts..." aria-label="Search" name="query" />
          <button class="btn btn-success" type="submit">Search</button>
        </form>
      </div>

      <!-- Table -->
      <div class="table-responsive">
        <table class="table align-middle table-hover">
          <thead class="table-light">
            <tr>
              <th scope="col">Featured Image</th>
              <th scope="col">Title</th>
              <th scope="col">Category</th>
              <th scope="col">Status</th>
              <th scope="col">Views</th>
              <th scope="col">Claps</th>
              <th scope="col">Comments</th>
              <th scope="col" class="text-end">Actions</th>
            </tr>
          </thead>
          <tbody>
            <!-- Example Row -->
            {% for post in user_posts %}
              <tr>
                {% if post.featured_image %}
                  <td>
                    <img src="{{ post.featured_image.url }}" class="rounded" alt="Featured Image" style="width: 60px; height: 40px; object-fit: cover;" />
                  </td>
                {% else %}
                  <td>
                    <img src="https://via.placeholder.com/60x40" class="rounded" alt="Default Image" style="width: 60px; height: 40px; object-fit: cover;" />
                  </td>
                {% endif %}

                <td><a href="{% url 'single_post' post.category.slug post.slug %}" class="text-decoration-none fw-bold">{{ post.title }}</a></td>
                <td>
                  <span class="badge bg-warning text-dark">{{ post.category }}</span>
                </td>
                <td>
                  <span class="badge bg-warning text-dark">{{ post.status|upper }}</span>
                </td>
                <td>{{ post.views }}</td>
                <td>{{ post.claps }}</td>
                <td>{{ post.posts.count }}</td>
                <td class="text-end">
                  <a href="{% url 'edit_guest_post' post.slug %}" class="btn btn-sm btn-outline-primary me-1">Edit</a>
                  <a href="{% url 'delete_guest_post' post.slug %}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure you want to delete this post?');">Delete</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
{% endblock %}
